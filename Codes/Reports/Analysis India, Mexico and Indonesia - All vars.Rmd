---
title: "Analysis of the COVID-19 Shock, Technology and Trade"
subtitle: "Regression Results for Mexico, India and Indonesia"
author: "Sim√≥n Caicedo"
date: \today
header-includes:
  \usepackage{float}
  \usepackage{placeins}
  \usepackage{rotating}
  \usepackage{graphicx}
  \usepackage{booktabs}
  \usepackage{caption}
  \usepackage{longtable}
  \usepackage{breqn}
output:
  pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.pos = 'H')
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning  = FALSE)
```

```{r, message=FALSE, warning=FALSE, echo=FALSE, results='hide'}

# Set Working Directory ----
fileloc <- dirname(rstudioapi::getSourceEditorContext()$path)
setwd(fileloc)
rm(fileloc)


# modelsummary package options----
options("modelsummary_format_numeric_latex" = "plain")


# Libraries to be used ----
source("../src/packages.R")

```

# 1. Does Tech Adoption Affect Trade Outcomes?

These regressions aim to analyze the relationship between technology adoption and trade outcomes (such as the value of imports/exports or the propensity to import/export) for specific types of products (e.g., online tradeable products, durable/consumption goods, time sensitive goods, among others). The regression model used is as follows:

\begin{equation}\label{reg_1}
    y_{ipt} = \alpha_0 + \alpha_1 tech_{i,t-l} \cdot category_{p} + \alpha_2 tech_{i,t-l} + FE_p + FE_i + FE_t + \epsilon_{ipt} 
\end{equation}


Where $y_{ipt}$ represents the trade outcome for the firm $i$ product $p$ in the month $t$. Specifically, the outcomes for the intensive margin regressions can be the logarithm of number of exports/imports for a product $p$ of a firm $i$ in the month $t$, the number of sources or destinations of a firm $i$ in a month $t$ for a product $p$ or a dummy indicating whether a firm $i$ in a month $t$ for a product $p$ is trading with a new source or a new destination. For the extensive margin regressions, we define as dependent variable a dummy indicating if the product $p$ of firm $i$ in the month $t$ is imported/exported or not, we called these variables import/export propensity. The variable $tech_{i,t-l}$ is a dummy indicating whether the firm $i$ in month $t-l$ ($l$ is the number of lags taken) used an adopted E-commerce or E-payment technology. The variable $category_p$ is a dummy variable that describes the category of product $p$. We analyze 2 categories of products: a) Products traded online from eBay or from China e-commerce tax lists, b) BEC Classification of products to differentiate between durable and consumption goods.

The interaction term $tech_{i,t-l} \cdot category_{p}$ captures the relationship between technology adoption and trade outcomes for products of a specific category.

Time fixed-effects control for unobserved variables that are constant at the firm-product level but vary over time. Firm fixed-effects control for unobserved time-and-product-invariant heterogeneities across firms. Similarly, product fixed-effects control for unobserved time-and-firm-invariant heterogeneities across products.

For each product category, we present three tables, each of which is estimated with a specific lag in the technology variable (E-payment or E-commerce).


## 1.1 Intensive Margin Analysis


```{r}

# India - intensive margin regressions of the model that measure if tech adoption affects trade outcomes
source("../India/05_regressions_product_model_lagged_definitive_IND.R", chdir = TRUE)

# Mexico - intensive margin regressions of the model that measure if tech adoption affects trade outcomes
source("../Mexico/05_regressions_product_model_lagged_definitive_MEX.R", chdir = TRUE)

# Indonesia - intensive margin regressions of the model that measure if tech adoption affects trade outcomes
source("../Indonesia/05_regressions_product_model_lagged_definitive_IDN.R", chdir = TRUE)


# Remove objects that are not longer needed
rm(pay_ecom_export_data_IND, pay_ecom_export_data_IDN,
   pay_ecom_export_data_MEX, pay_ecom_import_data_IDN, 
   pay_ecom_import_data_IND, pay_ecom_import_data_MEX)


```


### Log Imports and Log Exports

```{r, eval=TRUE}

log_imp_exp_IND[[2]]

```



```{r, eval=TRUE}

log_imp_exp_IDN[[2]]

```



```{r, eval = TRUE}

log_imp_exp_MEX[[2]]

```


### Number of destinations/sources


```{r, eval=TRUE}

no_source_dest_IND[[2]]

```



```{r, eval=TRUE}

no_source_dest_MEX[[2]]

```



```{r, eval = TRUE}

no_source_dest_IDN[[2]]

```



### New Source/Destination dummy

Since the available data for Indonesia is too limited to establish a baseline year, we will exclude these variables for this country.


```{r, eval=TRUE}

new_source_dest_IND[[2]]

```



```{r, eval=TRUE}

new_source_dest_MEX[[2]]

```


## 1.2 Extensive Margin Analysis

For the extensive margin analysis, we expand the dataset at the firm-month-HS6 level by using only feasible HS6 products, which we obtain through the HS4 codes. If a firm exports or imports an HS6 product, it is allowed the expansion of the firm in all months to all HS6 products in the HS4 code of the exported/imported HS6 product.


```{r, eval=T}

models_definitive_ext_IND<-readRDS("../../Outputs/India/regressions_results/products_model/models_definitive_2_lags_summary.RDS")[[2]]

models_definitive_ext_IND

```


```{r, eval=T}

models_definitive_ext_IDN<-readRDS("../../Outputs/Indonesia/regressions_results/products_model/models_definitive_2_lags_summary.rds")[[2]]

models_definitive_ext_IDN

```



```{r, eval=T}

models_definitive_ext_MEX<-readRDS("../../Outputs/Mexico/regressions_results/products_model/models_definitive_2_lags_summary.rds")[[2]]

models_definitive_ext_MEX

```



# 2. Does Existing Tech Use Mitigate COVID Impacts?

The aim of these regressions is to investigate whether companies that had adopted E-payment or E-commerce technology before 2019 were better equipped to mitigate the impacts of COVID on their product trade outcomes. The regression model is specified as follows:

\begin{dmath}\label{reg_2}
y_{ipt} = \alpha_0 + \alpha_1 tech_i \cdot covid_t + \alpha_2 tech_i \cdot covid_t \cdot category_p + \alpha_3 covid_t \cdot category_p + FE_p + FE_i + FE_t + \epsilon_{ipt}
\end{dmath}

Trade outcomes $y_{ipt}$ are the same as in equation (1). The variable $tech_i$ is a dummy variable indicating whether the company adopted an E-commerce or E-payment technology before 2019. $covid_t$ captures the impact of COVID using the monthly \textit{Stringency Index}, and $category_p$ is a dummy variable describing the category of product $p$.

The triple interaction term $tech_i \cdot covid_t \cdot category_p$ captures the effect of the adoption of E-commerce or E-payment technology before 2019 on mitigating the impact of COVID on trade outcomes for products of a specific category. The interaction term $tech_i \cdot covid_t$ investigates whether the adoption of E-commerce or E-payment technology before 2019 mitigates the impact of COVID on trade outcomes, without distinguishing by product category. The term $covid_t \cdot category_p$ examines the effect of COVID on trade outcomes of a specific category, without distinguishing by firms' adoption of e-commerce or e-payment technologies before 2019. Finally, fixed-effects are included for product, firm, and month.

## 2.1 Intensive Margin Analysis


```{r}

# India - intensive margin regressions of the model that measure if tech adoption mitigated covid impacts 
source("../India/06_regressions_tech_mitigation_covid_definitive_IND.R", chdir = TRUE)


# Mexico - intensive margin regressions of the model that measure if tech adoption mitigated covid impacts 
source("../Mexico/06_regressions_tech_mitigation_covid_definitive_MEX.R", chdir = TRUE)


# Indonesia - intensive margin regressions of the model that measure if tech adoption mitigated covid impacts 
source("../Indonesia/06_regressions_tech_mitigation_covid_definitive_IDN.R", chdir = TRUE)


```



### Log Imports and Log Exports

```{r, eval=TRUE}

log_imp_exp_covid_IND[[2]]

```



```{r, eval = TRUE}

log_imp_exp_covid_MEX[[2]]

```


```{r, eval=TRUE}

log_imp_exp_covid_IDN[[2]]

```



### Number of destinations/sources


```{r, eval=TRUE}

no_source_dest_covid_IND[[2]]

```



```{r, eval=TRUE}

no_source_dest_covid_MEX[[2]]

```



```{r, eval = TRUE}

no_source_dest_covid_IDN[[2]]

```



### New Source/Destination dummy

Since the available data for Indonesia is too limited to establish a baseline year, we will exclude these variables for this country.


```{r, eval=TRUE}

new_source_dest_covid_IND[[2]]

```



```{r, eval=TRUE}

new_source_dest_covid_MEX[[2]]

```


## 2.2 Extensive Margin Analysis

As in section 1.2, we expand the dataset at the firm-month-HS6 level by using only feasible HS6 products, which we obtain through the HS4 codes. If a firm exports or imports an HS6 product, it is allowed the expansion of the firm in all months to all HS6 products in the HS4 code of the exported/imported HS6 product.


```{r, eval=T}

models_definitive_ext_mitig_IND<-readRDS("../../Outputs/India/regressions_results/tech_mitigation_covid_model/models_tech_covid_definitive_summary_adopted_pay_or_ecom_before_2019.rds")[[2]]

models_definitive_ext_mitig_IND

```


```{r, eval=T}

models_definitive_ext_mitig_IDN<-readRDS("../../Outputs/Indonesia/regressions_results/tech_mitigation_covid_model/models_tech_covid_definitive_summary_adopted_pay_or_ecom_before_2019.rds")[[2]]

models_definitive_ext_mitig_IDN

```



```{r, eval=T}

models_definitive_ext_mitig_MEX<-readRDS("../../Outputs/Mexico/regressions_results/tech_mitigation_covid_model/models_tech_covid_definitive_summary_adopted_pay_or_ecom_before_2019.rds")[[2]]

models_definitive_ext_mitig_MEX

```
