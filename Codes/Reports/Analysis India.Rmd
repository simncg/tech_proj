---
title: "Analysis of the COVID-19 Shock, Technology and Trade"
subtitle: "Regression Results for India"
author: "Sim√≥n Caicedo"
date: \today
header-includes:
  \usepackage{float}
  \usepackage{placeins}
  \usepackage{rotating}
  \usepackage{graphicx}
  \usepackage{booktabs}
  \usepackage{caption}
  \usepackage{longtable}
  \usepackage{breqn}
output:
  pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.pos = 'H')
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning  = FALSE)
```

```{r, message=FALSE, warning=FALSE, echo=FALSE, results='hide'}

# Set Working Directory ----
fileloc <- dirname(rstudioapi::getSourceEditorContext()$path)
setwd(fileloc)
rm(fileloc)


# modelsummary package options----
options("modelsummary_format_numeric_latex" = "plain")


# Libraries to be used ----
source("../src/packages.R")

```

# 1. Intensive Margin Analysis

## 1.1 Does Tech Adoption Affect Trade Outcomes?

These regressions aim to analyze the relationship between technology adoption and trade outcomes (such as the value of imports/exports or the propensity to import/export) for specific types of products (e.g., online tradeable products, durable/consumption goods, time sensitive goods, among others). The regression model used is as follows:

\begin{equation}\label{reg_1}
    y_{ipt} = \alpha_0 + \alpha_1 tech_{i,t-l} \cdot category_{p} + \alpha_2 tech_{i,t-l} + FE_p + FE_i + FE_t + \epsilon_{ipt} 
\end{equation}


Where $y_{ipt}$ represents the trade outcome for the firm $i$ product $p$ in the month $t$. Specifically, the outcomes variable can be the logarithm of number of exports/imports for a product $p$ of a firm $i$ in the month $t$, or a dummy indicating if the product $p$ of firm $i$ in the month $t$ is imported/exported or not, we define these variables as the import/export propensity. The variable $tech_{i,t-l}$ is a dummy indicating whether the firm $i$ in month $t-l$ ($l$ is the number of lags taken with $l = \{1,2,3\}$) used an adopted E-commerce or E-payment technology. The variable $category_p$ is a dummy variable that describes the category of product $p$. We analyze 4 categories of products: a) Products traded online from eBay or from China e-commerce tax lists, b) BEC Classification of products to differentiate between durable, semi-durable and consumption goods, c) Products with different time-sensitivity, such as fresh or frozen products d, and (d) capital and intermediate products.  Additionally, we analyze four measures related to the products: Letter Credit Use, Mean Remote Work (ISIC), Relationship Stickiness, and the fraction of inputs not sold on the exchange and not referenced priced.

The interaction term $tech_{i,t-l} \cdot category_{p}$ captures the relationship between technology adoption and trade outcomes for products of a specific category.

Time fixed-effects control for unobserved variables that are constant at the firm-product level but vary over time. Firm fixed-effects control for unobserved time-and-product-invariant heterogeneities across firms. Similarly, product fixed-effects control for unobserved time-and-firm-invariant heterogeneities across products.

For each product category, we present three tables, each of which is estimated with a specific lag in the technology variable (E-payment or E-commerce).


```{r}

# Run regressions for products model for India 
source("../India/05_regressions_product_model_lagged_IND.R", chdir = TRUE)

```

### Results for eBay-tradable products/products in China e-commerce tax lists


```{r, eval=TRUE}

models_ebay_china_IND_t_1[[2]]

```


```{r, eval=TRUE}

models_ebay_china_IND_t_2[[2]]

```


```{r, eval=TRUE}

models_ebay_china_IND_t_3[[2]]

```



### Results for BEC products classification


```{r, eval=TRUE}

models_BEC_IND_t_1[[2]]

```


```{r, eval=TRUE}

models_BEC_IND_t_2[[2]]

```


```{r, eval=TRUE}

models_BEC_IND_t_3[[2]]

```

### Results for time-sensitive products




```{r, eval=TRUE}

models_time_sens_IND_t_1[[2]]

```



```{r, eval=TRUE}

models_time_sens_IND_t_2[[2]]

```



```{r, eval=TRUE}

models_time_sens_IND_t_3[[2]]

```




### Results for other HS products classification



```{r, eval=TRUE}

models_other_HS_IND_t_1[[2]]

```


```{r, eval=TRUE}

models_other_HS_IND_t_2[[2]]


```


```{r, eval=TRUE}

models_other_HS_IND_t_3[[2]]

```





### Results for capital - intermediate products classification



```{r, eval=TRUE}

models_cap_int_IND_t_1[[2]]

```


```{r, eval=TRUE}

models_cap_int_IND_t_2[[2]]


```


```{r, eval=TRUE}

models_cap_int_IND_t_3[[2]]

```


## 1.2 Does Existing Tech Use Mitigate COVID Impacts?

The aim of these regressions is to investigate whether companies that had adopted E-payment or E-commerce technology before 2019 were better equipped to mitigate the impacts of COVID on their product trade outcomes. The regression model is specified as follows:

\begin{dmath}\label{reg_2}
y_{ipt} = \alpha_0 + \alpha_1 tech_i \cdot covid_t + \alpha_2 tech_i \cdot covid_t \cdot category_p + \alpha_3 covid_t \cdot category_p + FE_p + FE_i + FE_t + \epsilon_{ipt}
\end{dmath}

Trade outcomes $y_{ipt}$ are the same as in equation (1). The variable $tech_i$ is a dummy variable indicating whether the company adopted an E-commerce or E-payment technology before 2019. $covid_t$ captures the impact of COVID using the monthly \textit{Stringency Index}, and $category_p$ is a dummy variable describing the category of product $p$.

The triple interaction term $tech_i \cdot covid_t \cdot category_p$ captures the effect of the adoption of E-commerce or E-payment technology before 2019 on mitigating the impact of COVID on trade outcomes for products of a specific category. The interaction term $tech_i \cdot covid_t$ investigates whether the adoption of E-commerce or E-payment technology before 2019 mitigates the impact of COVID on trade outcomes, without distinguishing by product category. The term $covid_t \cdot category_p$ examines the effect of COVID on trade outcomes of a specific category, without distinguishing by firms' adoption of e-commerce or e-payment technologies before 2019. Finally, fixed-effects are included for product, firm, and month.


```{r}

# Run regressions for products model for Indonesia 
source("../India/06_regressions_tech_mitigation_covid_IND.R", chdir = TRUE)

```


### Results for eBay-tradable products/products in China e-commerce tax lists


```{r, eval=T}

models_tech_covid_ebay_china_IND[[2]]

```


### Results for BEC products classification


```{r, eval=T}

models_tech_covid_BEC_IND[[2]]


```

### Results for time-sensitive products


```{r, eval=T}


models_covid_time_sensitivity_IND[[2]]

```


### Results for other HS products classification


```{r, eval=T}

models_covid_prods_impacted_IND[[2]]

```


### Results for Intermediate-Capital goods

```{r, eval=T}

models_covid_prods_cap_int_IND[[2]]

```


# 2. Extensive Margin Analysis

## 2.1 Does Tech Adoption Affect Trade Outcomes?

To capture the extensive margin, we defined different outcome variables at the firm-year-month level. Specifically, we computed the number of products exported, belonging to a specific category or not. For instance, let's assume a company exported four products in a given month, out of which only three are classified as E-commerce products. In that case, we considered two outcome variables: one for the number of exported E-commerce products (which equals three), and another for the number of exported non-E-commerce products (which equals one). Similarly, we computed the same variables for the number of imported products. In addition, we create dummy variables for each category indicating whether a firm exported or imported any products in that category during a given year-month. Specifically, for each category, we define a dummy variable equal to 1 if the firm exported at least one product in that category during the year-month, and 0 if not. We use the same approach to define a dummy variable for imported products in each category, equal to 1 if the firm imported at least one product in that category during the year-month, and 0 if not. To capture additional aspects of a firm's trade patterns, we define two variables that indicate the number of countries a firm exports to and imports from during a given year-month. Specifically, we compute the number of unique export partner countries and the number of unique import partner countries at the firm-year-month level. Finally, to create counts of the continuous measures Letter Credit Use, Mean Remote Work (ISIC), Relationship Stickiness, and the fraction of inputs not sold on the exchange and not referenced priced, we count the number of exported or imported products that are above the median value (across all products) in these measures. We also count the number of exported or imported products that are below the median. 

With these outcomes, we estimate the following regression:

\begin{equation}\label{reg_1_ext}
y_{it} = \alpha_0 + \alpha_1 tech_{i,t-l} + FE_{i} + FE_{t} + \varepsilon_{it}
\end{equation}

Where $y_{it}$ are the outcomes variables defined above. Note that for the count variables (i.e., the number of exported or imported products and the number of unique export or import partner countries), if the above regression is estimated using ordinary least squares (OLS), we apply a logarithmic transformation to the variable $y_{it}$ as $log(1 + y_{it})$. However, if the regression is estimated using the Poisson pseudo-maximum likelihood (PPML) method, we do not transform the variables. We present a table for each product category. 



```{r, eval=T}


results_mod1<-readRDS("../../Outputs/India/regressions_results/products_model/extensive_margin_results_mod1_IND.rds")

results_mod1_n_countries<-readRDS("../../Outputs/India/regressions_results/products_model/extensive_margin_results_mod1_n_countries_IND.rds")

```


```{r, eval = T}

results_mod1[[1]][[1]]


```



```{r, eval = T}

results_mod1[[2]][[1]]


```



```{r, eval = T}

results_mod1[[3]][[1]]


```


```{r, eval = T}

results_mod1[[4]][[1]]


```


```{r, eval = T}

results_mod1[[5]][[1]]


```


```{r, eval = T}

results_mod1[[6]][[1]]


```



```{r, eval = T}

results_mod1[[7]][[1]]


```



```{r, eval = T}

results_mod1[[8]][[1]]


```



```{r, eval = T}

results_mod1[[9]][[1]]


```


```{r, eval = T}

results_mod1[[10]][[1]]


```


```{r, eval = T}

results_mod1[[11]][[1]]


```


```{r, eval = T}

results_mod1[[12]][[1]]


```


```{r, eval = T}

results_mod1[[13]][[1]]


```


```{r, eval = T}

results_mod1[[14]][[1]]


```


```{r, eval = T}

results_mod1[[15]][[1]]


```


```{r, eval = T}

results_mod1[[16]][[1]]


```


```{r, eval = T}

results_mod1[[17]][[1]]


```


```{r, eval = T}

results_mod1[[18]][[1]]


```


```{r, eval = T}

results_mod1[[19]][[1]]


```



```{r, eval = T}

results_mod1[[20]][[1]]


```


```{r, eval = T}

results_mod1[[21]][[1]]


```


```{r, eval = T}

results_mod1[[22]][[1]]


```


```{r, eval = T}

results_mod1[[23]][[1]]


```


```{r, eval = T}

results_mod1_n_countries[[1]]

```

## 2.2 Does Existing Tech Use Mitigate COVID Impacts?

To capture the extensive margin we define the same outcome variables as in equation (3), but we estimate the following regression:

\begin{equation}\label{reg_2_ext}
y_{it} = \alpha_0 + \alpha_1 tech_{i}\cdot covid_t + FE_{i} + FE_{t} + \varepsilon_{it}
\end{equation}

Where $tech_i$ is a dummy variable indicating whether the company adopted an E-commerce or E-payment technology before 2019. $covid_t$ captures the impact of COVID using the monthly \textit{Stringency Index}. We present a table for each product category. 

```{r, eval=T}

results_mod2<-readRDS("../../Outputs/India/regressions_results/tech_mitigation_covid_model/extensive_margin_results_mod2_IND.rds")

results_mod2_n_countries<-readRDS("../../Outputs/India/regressions_results/tech_mitigation_covid_model/extensive_margin_results_mod2_n_countries_IND.rds")

```


```{r, eval = T}

results_mod2[[1]][[1]]


```



```{r, eval = T}

results_mod2[[2]][[1]]


```



```{r, eval = T}

results_mod2[[3]][[1]]


```


```{r, eval = T}

results_mod2[[4]][[1]]


```


```{r, eval = T}

results_mod2[[5]][[1]]


```


```{r, eval = T}

results_mod2[[6]][[1]]


```



```{r, eval = T}

results_mod2[[7]][[1]]


```



```{r, eval = T}

results_mod2[[8]][[1]]


```



```{r, eval = T}

results_mod2[[9]][[1]]


```


```{r, eval = T}

results_mod2[[10]][[1]]


```




```{r, eval = T}

results_mod2[[11]][[1]]


```


```{r, eval = T}

results_mod2[[12]][[1]]


```


```{r, eval = T}

results_mod2[[13]][[1]]


```


```{r, eval = T}

results_mod2[[14]][[1]]


```


```{r, eval = T}

results_mod2[[15]][[1]]


```


```{r, eval = T}

results_mod2[[16]][[1]]


```


```{r, eval = T}

results_mod2[[17]][[1]]


```


```{r, eval = T}

results_mod2[[18]][[1]]


```


```{r, eval = T}

results_mod2[[19]][[1]]


```



```{r, eval = T}

results_mod2[[20]][[1]]


```


```{r, eval = T}

results_mod2[[21]][[1]]


```


```{r, eval = T}

results_mod2[[22]][[1]]


```


```{r, eval = T}

results_mod2[[23]][[1]]


```


```{r, eval = T}

results_mod2_n_countries[[1]]

```
