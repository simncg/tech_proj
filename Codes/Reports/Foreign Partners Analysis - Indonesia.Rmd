---
title: "Analysis of the COVID-19 Shock, Technology and Trade"
subtitle: "Foreign Trade Partners Analysis - Indonesia and USA"
author: "Sim√≥n Caicedo"
date: \today
header-includes:
  \usepackage{float}
  \usepackage{placeins}
  \usepackage{rotating}
  \usepackage{graphicx}
  \usepackage{booktabs}
  \usepackage{caption}
  \usepackage{longtable}
  \usepackage{breqn}
  \usepackage{threeparttable}
output:
  pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.pos = 'H')
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning  = FALSE)
```


```{r, message=FALSE, warning=FALSE, echo=FALSE, results='hide'}

# Set Working Directory ----
fileloc <- dirname(rstudioapi::getSourceEditorContext()$path)
setwd(fileloc)
rm(fileloc)

# Libraries to be used ----
source("../src/packages.R")
source("../src/functions_foreign_partner_analysis.R")
library(ggpubr)


```

```{r}

# Read tables of foreign analysis
tables<-readRDS('../../Outputs/Indonesia/foreign_partners_analysis/Tables.RDS')

```


We examine the bilateral relationship between three categories of industries in Indonesia and the US: Wholesale/Retail, Manufacturing, and a category termed 'Rest,' which encompasses various industries such as Agriculture, Construction and Mining, Services, Finance, Insurance and Real Estate, and Transport and Utilities. In this context, 'Domestic industries' refers to those in Indonesia, while 'Foreign industries' denotes those in the United States.

To gain insight into the bilateral relationship between industries in Indonesia and the US, we examine five variables: 
    
  1. Number of Indonesian Firms: Refers to the number of indonesian firms in a specific industry trading (importing or exporting) with firms in a specific US industry. 
    
  2. Number of US firms: Indicates the number of US firms in a specific industry trading (importing or exporting) with firms in a specific Indonesian industry. 
    
  3. Average export/import value per Indonesian firm to/from US industry: This represents the average value of exports (to a US industry) or imports (from a US industry) for each individual Indonesian firm within a specific industry. For example, if there are three Indonesian firms in a particular industry with export values of $10,000, $15,000, and $25,000 to a specific US industry, the average export value per Indonesian firm to that US industry would be ($10,000 + $15,000 + $25,000) / 3 = $16,667. Similarly, for imports from the US industry to Indonesian firms, the calculation would follow the same approach using the import values.

  4. Average number of US importers/exporters per Indonesian firm: This represents the average number of US importers (for Indonesian exports) or exporters (for Indonesian imports) associated with each Indonesian firm within a specific industry.
    
  5. Average value of firm-to-firm exports/imports: This refers to the mean total value of exports (from an Indonesian firm to a US firm) or imports (from a US firm to an Indonesian firm) for firms within specific industries in both countries. For example, consider three transactions between an Indonesian firm in industry A and three US firms in industry B, with export values of $10,000, $15,000, and $25,000. The average value of firm-to-firm exports in this case would be ($10,000 + $15,000 + $25,000) / 3 = $16,667. The same approach would be applied to calculate the average value of firm-to-firm imports based on their respective import values.
    

# 1. Bilateral Industry Trade Patterns

In export terms, the highest average value per Indonesian firm and the greatest firm participation (number of US and Indonesian firms) are seen between Indonesia's manufacturing industry and the US wholesale/retail sector. This pairing also ranks third in firm-to-firm export value and the average number of US importers per Indonesian firm. For exports, the lowest values are found between Indonesia's wholesale/retail industry and the US manufacturing and 'Rest' categories.

For imports, the highest average value per Indonesian firm to a US industry is also observed in transactions between the Indonesian manufacturing industry and the US wholesale/retail industry. The Indonesian manufacturing industry's bilateral relation with the 'Rest' category yields the highest average value of firm-to-firm imports, followed by the bilateral relation between the Indonesian wholesale/retail industry and US wholesale/retail industry. The US wholesale/retail and manufacturing industries have the highest average number of exporters to Indonesian industries. The broadest firm participation, regarding the number of US and Indonesian firms, occurs between the Indonesian manufacturing industry and the US manufacturing industry. In import terms, the lowest participation is between the Indonesian wholesail/retail industry and both the US manufacturing industry and US industries in the 'Rest' category. 


```{r, eval = T, fig.width=10, fig.height=4}

plot_total_values(tables[["exports_complete"]], tables[["imports_complete"]])

```


# 2. Bilateral Industry Trade Patterns: Dissagregated by Product Category

To determine if industry-to-industry patterns are primarily influenced by specific product types, we disaggregate our variables of interest by product type. For instance, we compute the average export/import value per Indonesian firm to/from US industry and the average value of firm-to-firm imports/exports for both consumable and non-consumable goods, examining each category separately. Next, we plot the differences in these variables between consumable and non-consumable goods, allowing us to determine the extent of participation for consumable goods within a particular bilateral industry relationship. We do this analysis for four product categories: consumable goods, durable goods, products in China E-commerce tax list and e-Bay tradable products. 


## 2.1 Consumable Goods vs Non-Consumbale Goods

In export terms, both the average export value per Indonesian firm to US industry and firm-to-firm exports are larger for consumable goods compared to non-consumable goods in bilateral relations between: (1) Indonesian manufacturing and US wholesale/retail industries, and (2) Indonesian 'Rest' category and US manufacturing industry. For imports, the import value per Indonesian firm to US industry is larger for consumable goods than non-consumable goods in the bilateral relation between the Indonesian and US wholesale/retail industries. 


```{r, eval = T,  fig.width=10, fig.height=4}

plot_differences(tables[["cons_BEC"]][["Exports"]], tables[["cons_BEC"]][["Imports"]], ylab_title = "Difference in Trade Values (Consumable - Non-Consumable)")

```

## 2.2 Durable Goods vs Non-Durable Goods

In export terms, both the average export value per Indonesian firm to US industry and firm-to-firm exports are larger for durable goods compared to non-durable goods in the bilateral relation between the Indonesian and US manufacturing industries. 

Similar to the consumable goods case, in terms of imports, the import value per Indonesian firm to US industry is larger for durable goods than non-durable goods in the bilateral relation between the Indonesian and US wholesale/retail industries. 

```{r, eval = T, fig.width=10, fig.height=4}

plot_differences(tables[["durable_BEC"]][["Exports"]], tables[["durable_BEC"]][["Imports"]], ylab_title = "Difference in Trade Values (Durable - Non-Durable)")

```

## 2.3 Products in China E-commerce tax list vs Products not in China E-commerce tax list 

Similar to the consumable goods case, both the average export value per Indonesian firm to US industry and firm-to-firm exports are larger for products on the China E-commerce tax list compared to those not on the list in bilateral relations between: (1) Indonesian manufacturing and US wholesale/retail industries, and (2) Indonesian 'Rest' category and US manufacturing industry.

For imports, the bilateral relation between Indonesian and US wholesale/retail industries again plays a significant role, displaying larger values for both the average value of firm-to-firm imports and average import value per Indonesian firm to the US industry.

```{r, eval = T, fig.width=10, fig.height=4}

plot_differences(tables[["China_E_commerce"]][["Exports"]], tables[["China_E_commerce"]][["Imports"]], ylab_title = "Difference in Trade Values (E-commerce - Non-E-commerce)")

```

## 2.4 e-Bay tradable products vs Non-e-Bay tradable products

In export terms, both the average export value per Indonesian firm to US industry and firm-to-firm exports are significantly larger for e-Bay tradable products compared to non-e-Bay tradable products in bilateral relations between: (1) Indonesian manufacturing and US wholesale/retail industries, and (2) Indonesian wholesale/retail and US industries in the 'Rest' category. Interestingly, the average number of US importers per Indonesian firm is larger for e-Bay tradable products in almost all bilateral industry relations, except for the Indonesian wholesale/retail and US wholesale/retail industry pair.


```{r, eval = T, fig.width=10, fig.height=4}

plot_differences(tables[["Ebay_tradable"]][["Exports"]], tables[["Ebay_tradable"]][["Imports"]], ylab_title = "Difference in Trade Values (e-Bay tradable - Non-e-Bay tradable)")

```

# 3. Bilateral Industry Trade Patterns: Dissagregated by Technology Adoption

To assess whether industry-to-industry patterns are mainly driven by the adoption of e-commerce or e-payment technologies, we disaggregate our variables of interest by technology adoption. Specifically, we calculate each variable for every bilateral industry relationship, separately for firms that adopted e-payment or e-commerce technologies and those that did not adopt either technology. Following this, we compute the difference between the values of firms that adopted e-payment or e-commerce technologies and those that did not adopt either technology to determine if technology adoption significantly impacts specific bilateral industry relationships.


As illustrated in the plot below, the average export value per Indonesian firm and the average value of firm-to-firm exports are significantly higher for firms that adopted e-payment or e-commerce technologies in the bilateral industry relations between 1) the Indonesian Manufacturing industry and the US industries in the 'Rest' category, and 2) the Indonesian wholesale/retail industry and the US industries in the 'Rest' category.

For imports, bilateral relations between the Indonesian wholesale/retail industry and both the 'Rest' category and US wholesale/retail industries have notably larger average import value per Indonesian firm and firm-to-firm imports for firms that adopted e-payment or e-commerce technologies. Except for the Indonesian wholesale/retail and US wholesale/retail relationship, all bilateral industry relations have a larger average number of US exporters per Indonesian firm for companies that adopted these technologies. 


```{r, eval = T, fig.width=10, fig.height=4}

plot_differences(tables[["ever_pay_or_ecomnod"]][["Exports"]], tables[["ever_pay_or_ecomnod"]][["Imports"]], ylab_title = "Difference in Trade Values (Technology Adopted - Non-Technology Adopted)")

```


\newpage



# Appendix 

In addition to the plots presented in this report, we have included an appendix containing detailed tables for each of the analyzed variables. This supplementary information is provided for those who wish to examine the values and relationships more closely or prefer a tabular representation of the data.


# A.1. Bilateral Industry Trade Patterns

```{r, eval = T}

tables[["exports_complete"]] %>% 
  mutate(
    industry_local = case_when(
      industry_local == "MANUF" ~ "Manufacturing",
      industry_local == "WHL-RT" ~ "Wholesale/Retail",
      TRUE ~ industry_local
    ),
    industry_foreign = case_when(
      industry_foreign == "MANUF" ~ "Manufacturing",
      industry_foreign == "WHL-RT" ~ "Wholesale/Retail",
      TRUE ~ industry_foreign
    )
  ) %>% 
  kable(caption = "Export Dynamics: Indonesia Industries Trading with USA Industries", 
    col.names = linebreak(c("IDN Industry","USA Industry", "No. IDN Firms\nin Industry", "No. USA firms\nin Industry", "Avg. Export Value \n per IDN Firm\nto US Industry (\\$)", "Avg. No. US\nImporters per\nIDN firm", "Avg. Value of\nFirm-to-Firm\nExports (\\$)"), align = "c"),
    format = "latex", 
    align = c(rep("c", 7)),
    booktabs = T,
    escape = FALSE,
    digits = 2,
    format.args = list(big.mark = ",")) %>% 
  kable_styling(latex_options = c("HOLD_position", "scale_down"), position = "center")

```


```{r, eval = T}

tables[["imports_complete"]] %>% 
  mutate(
    industry_local = case_when(
      industry_local == "MANUF" ~ "Manufacturing",
      industry_local == "WHL-RT" ~ "Wholesale/Retail",
      TRUE ~ industry_local
    ),
    industry_foreign = case_when(
      industry_foreign == "MANUF" ~ "Manufacturing",
      industry_foreign == "WHL-RT" ~ "Wholesale/Retail",
      TRUE ~ industry_foreign
    )
  ) %>% 
  kable(caption = "Import Dynamics: Indonesia Industries Trading with USA Industries", 
    col.names = linebreak(c("IDN Industry","USA Industry", "No. IDN Firms\nin Industry", "No. USA firms\nin Industry", "Avg. Import Value \n per IDN Firm\nto US Industry (\\$)", "Avg. No. US\nExporters per\nIDN firm", "Avg. Value of\nFirm-to-Firm\nImports (\\$)"), align = "c"),
    #format = "latex", 
    align = c(rep("c", 7)),
    booktabs = T,
    escape = FALSE,
    digits = 2,
    format.args = list(big.mark = ",")) %>% 
  kable_styling(latex_options = c("HOLD_position", "scale_down"), position = "center")

```




# A.2 Bilateral Industry Trade Patterns: Dissagregated by Product Category

## A.2.1 Consumable Goods vs Non-Consumable Goods

```{r, eval = T}

cols_exports<-c("IDN Industry", "USA Industry", rep(c("No. IDN Firms\nin Industry", "Avg. Export Value \n per IDN Firm\nto US Industry (\\$)", "Avg. No. US\nImporters per\nIDN firm", "Avg. Value of\nFirm-to-Firm\nExports (\\$)"), 2))

tables[["cons_BEC"]][["Exports"]] %>% 
  relocate(matches("yes"), .before = 3) %>% 
  mutate(
    industry_local = case_when(
      industry_local == "MANUF" ~ "Manufacturing",
      industry_local == "WHL-RT" ~ "Wholesale/Retail",
      TRUE ~ industry_local
    ),
    industry_foreign = case_when(
      industry_foreign == "MANUF" ~ "Manufacturing",
      industry_foreign == "WHL-RT" ~ "Wholesale/Retail",
      TRUE ~ industry_foreign
    )
  ) %>% 
  kable(caption = "Exports Dynamics for Consumable Goods: Indonesia Industries Trading with USA Industries", 
    col.names = linebreak(cols_exports, align = "c"),
    #format = "latex", 
    align = c(rep("c", 7)),
    booktabs = T,
    escape = FALSE,
    digits = 2,
    format.args = list(big.mark = ",")) %>% 
  kable_styling(latex_options = c("HOLD_position", "scale_down"), position = "center") %>% 
  add_header_above(c(" " = 2, "Consumable Goods" = 4, "Non-Consumable Goods" = 4)) 

```


```{r, eval = T}

cols_imports<-c("IDN Industry", "USA Industry", rep(c("No. IDN Firms\nin Industry", "Avg. Import Value \n per IDN Firm\nto US Industry (\\$)", "Avg. No. US\nExporters per\nIDN firm", "Avg. Value of\nFirm-to-Firm\nImports (\\$)"), 2))

tables[["cons_BEC"]][["Imports"]] %>% 
  relocate(matches("yes"), .before = 3) %>% 
  mutate(
    industry_local = case_when(
      industry_local == "MANUF" ~ "Manufacturing",
      industry_local == "WHL-RT" ~ "Wholesale/Retail",
      TRUE ~ industry_local
    ),
    industry_foreign = case_when(
      industry_foreign == "MANUF" ~ "Manufacturing",
      industry_foreign == "WHL-RT" ~ "Wholesale/Retail",
      TRUE ~ industry_foreign
    )
  ) %>% 
  kable(caption = "Import Dynamics for Consumable Goods: Indonesia Industries Trading with USA Industries", 
    col.names = linebreak(cols_imports, align = "c"),
    #format = "latex", 
    align = c(rep("c", 7)),
    booktabs = T,
    escape = FALSE,
    digits = 2,
    format.args = list(big.mark = ",")) %>% 
  kable_styling(latex_options = c("HOLD_position", "scale_down"), position = "center") %>% 
  add_header_above(c(" " = 2, "Consumable Goods" = 4, "Non-Consumable Goods" = 4)) 

```


## A.2.2 Durable Goods vs Non-Durable Goods

```{r, eval = T}

cols_exports<-c("IDN Industry", "USA Industry", rep(c("No. IDN Firms\nin Industry", "Avg. Export Value \n per IDN Firm\nto US Industry (\\$)", "Avg. No. US\nImporters per\nIDN firm", "Avg. Value of\nFirm-to-Firm\nExports (\\$)"), 2))

tables[["durable_BEC"]][["Exports"]] %>% 
  relocate(matches("yes"), .before = 3) %>% 
  mutate(
    industry_local = case_when(
      industry_local == "MANUF" ~ "Manufacturing",
      industry_local == "WHL-RT" ~ "Wholesale/Retail",
      TRUE ~ industry_local
    ),
    industry_foreign = case_when(
      industry_foreign == "MANUF" ~ "Manufacturing",
      industry_foreign == "WHL-RT" ~ "Wholesale/Retail",
      TRUE ~ industry_foreign
    )
  ) %>% 
  kable(caption = "Exports Dynamics for Durable Goods: Indonesia Industries Trading with USA Industries", 
    col.names = linebreak(cols_exports, align = "c"),
    #format = "latex", 
    align = c(rep("c", 7)),
    booktabs = T,
    escape = FALSE,
    digits = 2,
    format.args = list(big.mark = ",")) %>% 
  kable_styling(latex_options = c("HOLD_position", "scale_down"), position = "center") %>% 
  add_header_above(c(" " = 2, "Consumable Goods" = 4, "Non-Consumable Goods" = 4)) 

```


```{r, eval = T}

cols_imports<-c("IDN Industry", "USA Industry", rep(c("No. IDN Firms\nin Industry", "Avg. Import Value \n per IDN Firm\nto US Industry (\\$)", "Avg. No. US\nExporters per\nIDN firm", "Avg. Value of\nFirm-to-Firm\nImports (\\$)"), 2))

tables[["durable_BEC"]][["Imports"]] %>% 
  relocate(matches("yes"), .before = 3) %>% 
  mutate(
    industry_local = case_when(
      industry_local == "MANUF" ~ "Manufacturing",
      industry_local == "WHL-RT" ~ "Wholesale/Retail",
      TRUE ~ industry_local
    ),
    industry_foreign = case_when(
      industry_foreign == "MANUF" ~ "Manufacturing",
      industry_foreign == "WHL-RT" ~ "Wholesale/Retail",
      TRUE ~ industry_foreign
    )
  ) %>% 
  kable(caption = "Import Dynamics for Durable Goods: Indonesia Industries Trading with USA Industries", 
    col.names = linebreak(cols_imports, align = "c"),
    #format = "latex", 
    align = c(rep("c", 7)),
    booktabs = T,
    escape = FALSE,
    digits = 2,
    format.args = list(big.mark = ",")) %>% 
  kable_styling(latex_options = c("HOLD_position", "scale_down"), position = "center") %>% 
  add_header_above(c(" " = 2, "Durable Goods" = 4, "Non-durable Goods" = 4)) 

```



## A.2.3 Products in China E-commerce tax list vs Products not in China-E-commerce tax list

```{r, eval = T}

cols_exports<-c("IDN Industry", "USA Industry", rep(c("No. IDN Firms\nin Industry", "Avg. Export Value \n per IDN Firm\nto US Industry (\\$)", "Avg. No. US\nImporters per\nIDN firm", "Avg. Value of\nFirm-to-Firm\nExports (\\$)"), 2))

tables[["China_E_commerce"]][["Exports"]] %>% 
  relocate(matches("yes"), .before = 3) %>% 
  mutate(
    industry_local = case_when(
      industry_local == "MANUF" ~ "Manufacturing",
      industry_local == "WHL-RT" ~ "Wholesale/Retail",
      TRUE ~ industry_local
    ),
    industry_foreign = case_when(
      industry_foreign == "MANUF" ~ "Manufacturing",
      industry_foreign == "WHL-RT" ~ "Wholesale/Retail",
      TRUE ~ industry_foreign
    )
  ) %>% 
  kable(caption = "Exports Dynamics for products in China E-commerce tax list: Indonesia Industries Trading with USA Industries", 
    col.names = linebreak(cols_exports, align = "c"),
    #format = "latex", 
    align = c(rep("c", 7)),
    booktabs = T,
    escape = FALSE,
    digits = 2,
    format.args = list(big.mark = ",")) %>% 
  kable_styling(latex_options = c("HOLD_position", "scale_down"), position = "center") %>% 
  add_header_above(c(" " = 2, "China E-commerce Product" = 4, "Non-China E-commerce Product" = 4)) 

```


```{r, eval = T}

cols_imports<-c("IDN Industry", "USA Industry", rep(c("No. IDN Firms\nin Industry", "Avg. Import Value \n per IDN Firm\nto US Industry (\\$)", "Avg. No. US\nExporters per\nIDN firm", "Avg. Value of\nFirm-to-Firm\nImports (\\$)"), 2))

tables[["China_E_commerce"]][["Imports"]] %>% 
  relocate(matches("yes"), .before = 3) %>% 
  mutate(
    industry_local = case_when(
      industry_local == "MANUF" ~ "Manufacturing",
      industry_local == "WHL-RT" ~ "Wholesale/Retail",
      TRUE ~ industry_local
    ),
    industry_foreign = case_when(
      industry_foreign == "MANUF" ~ "Manufacturing",
      industry_foreign == "WHL-RT" ~ "Wholesale/Retail",
      TRUE ~ industry_foreign
    )
  ) %>% 
  kable(caption = "Import Dynamics for products in China E-commerce tax list: Indonesia Industries Trading with USA Industries", 
    col.names = linebreak(cols_imports, align = "c"),
    #format = "latex", 
    align = c(rep("c", 7)),
    booktabs = T,
    escape = FALSE,
    digits = 2,
    format.args = list(big.mark = ",")) %>% 
  kable_styling(latex_options = c("HOLD_position", "scale_down"), position = "center") %>% 
  add_header_above(c(" " = 2, "China E-commerce Product" = 4, "Non-China E-commerce Product" = 4)) 

```

## A.2.4 e-Bay tradable products vs Non-e-Bay tradable products

```{r, eval = T}

cols_exports<-c("IDN Industry", "USA Industry", rep(c("No. IDN Firms\nin Industry", "Avg. Export Value \n per IDN Firm\nto US Industry (\\$)", "Avg. No. US\nImporters per\nIDN firm", "Avg. Value of\nFirm-to-Firm\nExports (\\$)"), 2))

tables[["Ebay_tradable"]][["Exports"]] %>% 
  relocate(matches("yes"), .before = 3) %>% 
  mutate(
    industry_local = case_when(
      industry_local == "MANUF" ~ "Manufacturing",
      industry_local == "WHL-RT" ~ "Wholesale/Retail",
      TRUE ~ industry_local
    ),
    industry_foreign = case_when(
      industry_foreign == "MANUF" ~ "Manufacturing",
      industry_foreign == "WHL-RT" ~ "Wholesale/Retail",
      TRUE ~ industry_foreign
    )
  ) %>% 
  kable(caption = "Exports Dynamics for e-Bay tradable products: Indonesia Industries Trading with USA Industries", 
    col.names = linebreak(cols_exports, align = "c"),
    #format = "latex", 
    align = c(rep("c", 7)),
    booktabs = T,
    escape = FALSE,
    digits = 2,
    format.args = list(big.mark = ",")) %>% 
  kable_styling(latex_options = c("HOLD_position", "scale_down"), position = "center") %>% 
  add_header_above(c(" " = 2, "e-Bay tradable product" = 4, "Non-e-Bay tradable product" = 4)) 

```


```{r, eval = T}

cols_imports<-c("IDN Industry", "USA Industry", rep(c("No. IDN Firms\nin Industry", "Avg. Import Value \n per IDN Firm\nto US Industry (\\$)", "Avg. No. US\nExporters per\nIDN firm", "Avg. Value of\nFirm-to-Firm\nImports (\\$)"), 2))

tables[["Ebay_tradable"]][["Imports"]] %>% 
  relocate(matches("yes"), .before = 3) %>% 
  mutate(
    industry_local = case_when(
      industry_local == "MANUF" ~ "Manufacturing",
      industry_local == "WHL-RT" ~ "Wholesale/Retail",
      TRUE ~ industry_local
    ),
    industry_foreign = case_when(
      industry_foreign == "MANUF" ~ "Manufacturing",
      industry_foreign == "WHL-RT" ~ "Wholesale/Retail",
      TRUE ~ industry_foreign
    )
  ) %>% 
  kable(caption = "Import Dynamics for e-Bay tradable products: Indonesia Industries Trading with USA Industries", 
    col.names = linebreak(cols_imports, align = "c"),
    #format = "latex", 
    align = c(rep("c", 7)),
    booktabs = T,
    escape = FALSE,
    digits = 2,
    format.args = list(big.mark = ",")) %>% 
  kable_styling(latex_options = c("HOLD_position", "scale_down"), position = "center") %>% 
  add_header_above(c(" " = 2, "e-Bay tradable product" = 4, "Non-e-Bay tradable product" = 4)) 

```


# A.3 Bilateral Industry Trade Patterns: Dissagregated by Technology Adoption

```{r, eval = T}

cols_exports<-c("IDN Industry", "USA Industry", rep(c("No. IDN Firms\nin Industry", "Avg. Export Value \n per IDN Firm\nto US Industry (\\$)", "Avg. No. US\nImporters per\nIDN firm", "Avg. Value of\nFirm-to-Firm\nExports (\\$)"), 2))

tables[["ever_pay_or_ecomnod"]][["Exports"]] %>% 
  relocate(matches("yes"), .before = 3) %>% 
  select(-contains("NA")) %>% 
  mutate(
    industry_local = case_when(
      industry_local == "MANUF" ~ "Manufacturing",
      industry_local == "WHL-RT" ~ "Wholesale/Retail",
      TRUE ~ industry_local
    ),
    industry_foreign = case_when(
      industry_foreign == "MANUF" ~ "Manufacturing",
      industry_foreign == "WHL-RT" ~ "Wholesale/Retail",
      TRUE ~ industry_foreign
    )
  ) %>% 
  kable(caption = "Exports Dynamics by Technology Adoption: Indonesia Industries Trading with USA Industries", 
    col.names = linebreak(cols_exports, align = "c"),
    #format = "latex", 
    align = c(rep("c", 7)),
    booktabs = T,
    escape = FALSE,
    digits = 2,
    format.args = list(big.mark = ",")) %>% 
  kable_styling(latex_options = c("HOLD_position", "scale_down"), position = "center") %>% 
  add_header_above(c(" " = 2, "E-commerce/E-payment Adopted" = 4, "E-commerce/E-payment Not Adopted" = 4)) 

```


```{r, eval = T}

cols_imports<-c("IDN Industry", "USA Industry", rep(c("No. IDN Firms\nin Industry", "Avg. Import Value \n per IDN Firm\nto US Industry (\\$)", "Avg. No. US\nExporters per\nIDN firm", "Avg. Value of\nFirm-to-Firm\nImports (\\$)"), 2))

tables[["ever_pay_or_ecomnod"]][["Imports"]] %>% 
  relocate(matches("yes"), .before = 3) %>% 
  select(-contains("NA")) %>% 
  mutate(
    industry_local = case_when(
      industry_local == "MANUF" ~ "Manufacturing",
      industry_local == "WHL-RT" ~ "Wholesale/Retail",
      TRUE ~ industry_local
    ),
    industry_foreign = case_when(
      industry_foreign == "MANUF" ~ "Manufacturing",
      industry_foreign == "WHL-RT" ~ "Wholesale/Retail",
      TRUE ~ industry_foreign
    )
  ) %>% 
  kable(caption = "Import Dynamics by Technology Adoption: Indonesia Industries Trading with USA Industries", 
    col.names = linebreak(cols_imports, align = "c"),
    #format = "latex", 
    align = c(rep("c", 7)),
    booktabs = T,
    escape = FALSE,
    digits = 2,
    format.args = list(big.mark = ",")) %>% 
  kable_styling(latex_options = c("HOLD_position", "scale_down"), position = "center") %>% 
  add_header_above(c(" " = 2, "E-commerce/E-payment Adopted" = 4, "E-commerce/E-payment Not Adopted" = 4)) 

```




